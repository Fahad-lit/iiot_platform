import React, { useState, useEffect } from 'react'\nimport { LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts'\nimport { Cpu, Activity, AlertCircle, TrendingUp } from 'lucide-react'\nimport StatCard from '../components/StatCard'\nimport axios from 'axios'\n\nfunction Dashboard() {\n  const [systemData, setSystemData] = useState(null)\n  const [chartData, setChartData] = useState([\n    { time: '00:00', temperature: 22, humidity: 45, pressure: 1013 },\n    { time: '04:00', temperature: 20, humidity: 50, pressure: 1012 },\n    { time: '08:00', temperature: 24, humidity: 48, pressure: 1013 },\n    { time: '12:00', temperature: 28, humidity: 42, pressure: 1014 },\n    { time: '16:00', temperature: 26, humidity: 46, pressure: 1013 },\n    { time: '20:00', temperature: 23, humidity: 49, pressure: 1012 },\n  ])\n  const [loading, setLoading] = useState(true)\n\n  useEffect(() => {\n    fetchSystemData()\n  }, [])\n\n  const fetchSystemData = async () => {\n    try {\n      const response = await axios.get('/api/analytics/summary')\n      setSystemData(response.data)\n      setLoading(false)\n    } catch (error) {\n      console.error('خطأ في جلب البيانات:', error)\n      setLoading(false)\n    }\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-full\">\n        <div className=\"spinner\"></div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"p-8 space-y-8\">\n      {/* Header */}\n      <div>\n        <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white\">لوحة التحكم</h1>\n        <p className=\"text-gray-600 dark:text-gray-400 mt-2\">مرحبًا بك في منصة إنترنت الأشياء الصناعية</p>\n      </div>\n\n      {/* Stats Grid */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n        <StatCard\n          title=\"إجمالي الأجهزة\"\n          value={systemData?.total_devices || 0}\n          icon={Cpu}\n          color=\"blue\"\n          trend={{ direction: 'up', value: 12 }}\n        />\n        <StatCard\n          title=\"الأجهزة النشطة\"\n          value={systemData?.active_devices || 0}\n          icon={Activity}\n          color=\"green\"\n          trend={{ direction: 'up', value: 8 }}\n        />\n        <StatCard\n          title=\"التنبيهات النشطة\"\n          value={systemData?.unresolved_alerts || 0}\n          icon={AlertCircle}\n          color=\"red\"\n          trend={{ direction: 'down', value: 5 }}\n        />\n        <StatCard\n          title=\"صحة النظام\"\n          value={`${Math.round(systemData?.system_health || 0)}%`}\n          icon={TrendingUp}\n          color=\"yellow\"\n        />\n      </div>\n\n      {/* Charts */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Temperature Chart */}\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow p-6\">\n          <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n            درجة الحرارة\n          </h2>\n          <ResponsiveContainer width=\"100%\" height={300}>\n            <LineChart data={chartData}>\n              <CartesianGrid strokeDasharray=\"3 3\" />\n              <XAxis dataKey=\"time\" />\n              <YAxis />\n              <Tooltip />\n              <Legend />\n              <Line\n                type=\"monotone\"\n                dataKey=\"temperature\"\n                stroke=\"#ef4444\"\n                name=\"درجة الحرارة (°C)\"\n              />\n            </LineChart>\n          </ResponsiveContainer>\n        </div>\n\n        {/* Humidity & Pressure Chart */}\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow p-6\">\n          <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n            الرطوبة والضغط\n          </h2>\n          <ResponsiveContainer width=\"100%\" height={300}>\n            <BarChart data={chartData}>\n              <CartesianGrid strokeDasharray=\"3 3\" />\n              <XAxis dataKey=\"time\" />\n              <YAxis />\n              <Tooltip />\n              <Legend />\n              <Bar dataKey=\"humidity\" fill=\"#3b82f6\" name=\"الرطوبة (%)\" />\n              <Bar dataKey=\"pressure\" fill=\"#8b5cf6\" name=\"الضغط (Pa)\" />\n            </BarChart>\n          </ResponsiveContainer>\n        </div>\n      </div>\n\n      {/* Recent Alerts */}\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow p-6\">\n        <h2 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n          التنبيهات الأخيرة\n        </h2>\n        <div className=\"space-y-3\">\n          {[\n            { id: 1, device: 'sensor_001', message: 'درجة الحرارة مرتفعة', severity: 'critical' },\n            { id: 2, device: 'sensor_002', message: 'الضغط منخفض', severity: 'warning' },\n            { id: 3, device: 'sensor_003', message: 'الرطوبة غير طبيعية', severity: 'info' },\n          ].map((alert) => (\n            <div\n              key={alert.id}\n              className={`p-4 rounded-lg border-r-4 ${\n                alert.severity === 'critical'\n                  ? 'bg-red-50 dark:bg-red-900 border-red-500'\n                  : alert.severity === 'warning'\n                  ? 'bg-yellow-50 dark:bg-yellow-900 border-yellow-500'\n                  : 'bg-blue-50 dark:bg-blue-900 border-blue-500'\n              }`}\n            >\n              <div className=\"flex justify-between items-center\">\n                <div>\n                  <p className=\"font-semibold text-gray-900 dark:text-white\">\n                    {alert.device}\n                  </p>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                    {alert.message}\n                  </p>\n                </div>\n                <span className={`px-3 py-1 rounded-full text-sm font-medium ${\n                  alert.severity === 'critical'\n                    ? 'bg-red-200 text-red-800'\n                    : alert.severity === 'warning'\n                    ? 'bg-yellow-200 text-yellow-800'\n                    : 'bg-blue-200 text-blue-800'\n                }`}>\n                  {alert.severity === 'critical' ? 'حرج' : alert.severity === 'warning' ? 'تحذير' : 'معلومة'}\n                </span>\n              </div>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default Dashboard\n
